' Gambas class file

Public state As FormState
Public onBreak As Boolean

Public Sub Form_Open()
  state = New FormState As "State"
  Timer1.Delay = 400
  Timer1.Enabled = True
End

Public Sub State_completion()
  CompletionForm.Show()
End

Public Sub Timer1_Timer()
  LCDMinSec.Text = state.mmss()
  LCDTotalCount.Text = state.total
End

Public Sub InterruptionBtn_Click()
  If state.paused
    state.unpause()
    InterruptionBtn.Background = -1
    InterruptionBtn.Text = "Interuption"
  Else
    state.pause()
    InterruptionBtn.Text = "Resume"
    InterruptionBtn.Background = Color.Red
  End If
End

Public Sub CancelBtn_Click()
  state.resetPom()
End

Public Sub NewBtn_Click()
  state.startPom()
End

Public Sub QuitBtn_Click()
  Quit
End

Public Sub BreakBtn_Click()
  If onBreak
    state.stopBreak()
    onBreak = False
    BreakBtn.Background = -1
    BreakBtn.Text = "Break"
  Else
    state.startBreak()
    onBreak = True
    BreakBtn.Background = Color.Red
    BreakBtn.Text = "Unbreak"
  End If
End
